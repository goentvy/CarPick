<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
    <meta charset="UTF-8">
    <title>카픽 - 이벤트</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- CSS -->
	<link rel="shortcut icon" type="image/png" href="assets/images/icon/favicon.ico">
	<link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/assets/css/font-awesome.min.css}">
	<link rel="stylesheet" th:href="@{/assets/css/common.css}">
	<link rel="stylesheet" th:href="@{/assets/css/themify-icons.css}">
	<link rel="stylesheet" th:href="@{/assets/css/metisMenu.css}">
	<link rel="stylesheet" th:href="@{/assets/css/owl.carousel.min.css}">
	<link rel="stylesheet" th:href="@{/assets/css/slicknav.min.css}">

	<!-- amchart css (CDN) -->
	<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />

	<!-- Others CSS -->
	<link rel="stylesheet" th:href="@{/assets/css/typography.css}">
	<link rel="stylesheet" th:href="@{/assets/css/default-css.css}">
	<link rel="stylesheet" th:href="@{/assets/css/styles.css}">
	<link rel="stylesheet" th:href="@{/assets/css/responsive.css}">

	<!-- JS -->
	<script th:src="@{/assets/js/vendor/modernizr-2.8.3.min.js}"></script>

	<!-- jQuery UI -->
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">


</head>

<body>

<div class="page-container">

    <!-- ⭐ 사이드바 include -->
    <div th:replace="fragments/fragments :: sidebar"></div>


    <!-- ⭐ header include -->
    <div th:replace="fragments/fragments :: header"></div>

    <!-- ⭐ 본문 영역 -->
    <!-- main content area start -->
	<form th:object="${event}" action="/admin/event_write" method="post" enctype="multipart/form-data">
	<input type="hidden" th:field="*{id}" name="id">
	<div class="main-content">
	    <!-- page title area start -->
	    <div class="page-title-area">
	        <div class="row align-items-center">
	            <div class="col-sm-6">
	                <div class="breadcrumbs-area clearfix">
	                    <h4 class="page-title pull-left">이벤트 관리</h4>
	                    <ul class="breadcrumbs pull-left">
	                        <li><a href="/admin">홈</a></li>
	                        <li><span>이벤트 관리</span></li>
	                    </ul>
	                </div>
	            </div>
	            <div class="col-sm-6 clearfix">
					<button type="submit" class="user-profile pull-right user_writeBtn">
					    <span th:text="${event.id != 0 ? '이벤트 수정' : '이벤트 등록'}"></span>
					</button>
	            </div>
	        </div>
	    </div>
	    <!-- page title area end -->
		
	    <div class="main-content-inner">
	        <div class="row">
	            <div class="col-12 mt-5">
	                <div class="card">
	                    <div class="card-body">
	                        <h4 class="header-title">이벤트 관리</h4>

	                        <!-- 제목 -->
	                        <div class="form-group">
	                            <label for="title" class="col-form-label">제목</label>
	                            <input class="form-control" name="title" type="text" th:field="*{title}" id="title">
	                        </div>

	                        <!-- 이벤트 기간 -->
	                        <div class="form-group">
	                            <label for="period" class="col-form-label">이벤트 기간</label>
	                            <div class="row align-items-center" style="margin:0">
									<input class="form-control" type="text" name="startDate" th:field="*{startDate}" id="startDate" style="width:150px; margin-right:10px; "> -  
									<input class="form-control" type="text" name="endDate" th:field="*{endDate}" id="endDate"  style="width:150px; margin-left:10px; ">
								</div>
	                        </div>

	                        <!-- 내용 -->
	                        <div class="form-group">
	                            <label for="content" class="col-form-label">내용</label>
	                            <textarea rows="5" class="form-control" th:field="*{content}" name="content" id="content"></textarea>
	                        </div>

	                        <!-- 썸네일 -->
	                        <div class="form-group">
	                            <label for="thumbnail" class="col-form-label">썸네일</label>
								<input type="file" class="form-control" th:field="*{thumbnailFile}" name="thumbnail" accept="image/*">
	                            <!-- 기존 썸네일 미리보기 -->
	                            <div th:if="${event.thumbnail != null}" class="row align-items-center" style="margin:0;margin-top:10px; ">
	                                <img th:src="@{/upload/event/{file}(file=*{thumbnail})}"
	                                     alt="썸네일"
	                                     style="width:80px; height:60px; object-fit:cover; margin-right:10px; ">
									 <div class="custom-control custom-checkbox">
                                         <input type="checkbox" name="thumbnailDelete" class="custom-control-input" id="customCheck1">
                                         <label class="custom-control-label" for="customCheck1">체크 시 썸네일 이미지가 삭제됩니다.</label>
                                     </div>
	                            </div>
	                        </div>

	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	</div>
	</form>
	<!-- main content area end -->

    <!-- ⭐ footer include -->
    <div th:replace="fragments/fragments :: footer"></div>

</div>


<!-- jquery latest version -->
<script th:src="@{/assets/js/vendor/jquery-2.2.4.min.js}"></script>

<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>

<!-- bootstrap 4 js -->
<script th:src="@{/assets/js/popper.min.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

<script th:src="@{/assets/js/owl.carousel.min.js}"></script>
<script th:src="@{/assets/js/metisMenu.min.js}"></script>
<script th:src="@{/assets/js/jquery.slimscroll.min.js}"></script>
<script th:src="@{/assets/js/jquery.slicknav.min.js}"></script>

<!-- Summernote -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote.min.js"></script>

<!-- 한글 -->
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/lang/summernote-ko-KR.min.js"></script>

<!-- start chart js (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

<!-- start highcharts js (CDN) -->
<script src="https://code.highcharts.com/highcharts.js"></script>

<!-- start zingchart js (CDN) -->
<script src="https://cdn.zingchart.com/zingchart.min.js"></script>
<script>
    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
</script>

<!-- all line chart activation -->
<script th:src="@{/assets/js/line-chart.js}"></script>

<!-- all bar chart activation -->
<script th:src="@{/assets/js/bar-chart.js}"></script>

<!-- all pie chart -->
<script th:src="@{/assets/js/pie-chart.js}"></script>

<!-- others plugins -->
<script th:src="@{/assets/js/plugins.js}"></script>
<script th:src="@{/assets/js/scripts.js}"></script>

<script>
$(function () {
    $("#startDate").datepicker({
        dateFormat: "yy-mm-dd",
		changeMonth: true,
		changeYear: true,
		dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일'],
		dayNamesMin: ['일','월','화','수','목','금','토'],
		monthNamesShort: [ "1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월" ],
		showOtherMonths: true,
        onClose: function (selectedDate) {
            $("#endDate").datepicker("option", "minDate", selectedDate);
        }
    });

    $("#endDate").datepicker({
        dateFormat: "yy-mm-dd",
		changeMonth: true,
		changeYear: true,
		dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일'],
		dayNamesMin: ['일','월','화','수','목','금','토'],
		monthNamesShort: [ "1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월" ],
		showOtherMonths: true,
        onClose: function (selectedDate) {
            $("#startDate").datepicker("option", "maxDate", selectedDate);
        }
    });
	
	$('#content').summernote({
        height: 300,
        lang: 'ko-KR',
        placeholder: '내용을 입력하세요',
        callbacks: {
            onImageUpload: function(files) {
                uploadImage(files[0]);
            }
        }
    });
	
	function uploadImage(file) {
	    let formData = new FormData();
	    formData.append("file", file);

	    $.ajax({
	        url: "/admin/upload/content-image",
	        type: "POST",
	        data: formData,
	        contentType: false,
	        processData: false,
	        success: function (imageUrl) {
	            $('#content').summernote('insertImage', imageUrl);
	        },
	        error: function () {
	            alert("이미지 업로드 실패");
	        }
	    });
	}
});
</script>




</body>
</html>
