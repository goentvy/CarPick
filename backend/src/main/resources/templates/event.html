<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
    <meta charset="UTF-8">
    <title>카픽 - 이벤트 관리</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- CSS -->
	<link rel="shortcut icon" type="image/png" href="assets/images/icon/favicon.ico">

	<!-- amchart css (CDN) -->
	<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />

	<!-- Others CSS -->
	<link rel="stylesheet" th:href="@{/assets/css/typography.css}">
	<link rel="stylesheet" th:href="@{/assets/css/default-css.css}">
	<link rel="stylesheet" th:href="@{/assets/css/styles.css}">
	<link rel="stylesheet" th:href="@{/assets/css/responsive.css}">
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/common.css}">
    <link rel="stylesheet" th:href="@{/assets/css/themify-icons.css}">
    <link rel="stylesheet" th:href="@{/assets/css/metisMenu.css}">
    <link rel="stylesheet" th:href="@{/assets/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/slicknav.min.css}">

	<!-- JS -->
	<script th:src="@{/assets/js/vendor/modernizr-2.8.3.min.js}"></script>

</head>

<body>

<div class="page-container">

    <!-- ⭐ 사이드바 include -->
    <div th:replace="fragments/fragments :: sidebar"></div>


    <!-- ⭐ header include -->
    <div th:replace="fragments/fragments :: header"></div>

    <!-- ⭐ 본문 영역 -->
    <!-- main content area start -->
	<div class="main-content">
	    <!-- page title area start -->
	    <div class="page-title-area">
	        <div class="row align-items-center">
	            <div class="col-sm-6">
	                <div class="breadcrumbs-area clearfix">
	                    <h4 class="page-title pull-left">이벤트 관리</h4>
	                    <ul class="breadcrumbs pull-left">
	                        <li><a href="/admin">홈</a></li>
	                        <li><span>이벤트 관리</span></li>
	                    </ul>
	                </div>
	            </div>
				<div class="col-sm-6 clearfix">
					<button class="user-profile user_writeBtn pull-right" onclick="location.href='/admin/event_write'">
	                    이벤트 등록
	                </button>
	            </div>
	        </div>
	    </div>
	    <!-- page title area end -->
		<div class="main-content-inner">
			<form method="get" action="/admin/event">
				<div class="col-lg-12 mt-4">
					<div class="row">
						<button class="btn btn-light dropdown-toggle btn-event mr-1"
						        type="button"
						        data-toggle="dropdown">

						    <span th:text="${type == 'end' ? '마감된 이벤트' : '진행중 이벤트'}"></span>
						</button>

						<div class="dropdown-menu">
						    <a class="dropdown-item" th:href="@{/admin/event(type='end')}">
						        마감된 이벤트
						    </a>
						    <a class="dropdown-item" th:href="@{/admin/event}">
						        진행중 이벤트
						    </a>
						</div>

						<div class="search-box pull-left mr-1">
	                        <input type="text" name="search" placeholder="Search..." th:value="${search}" required>
	                    </div>
						<div class="search-btn">
							<button type="submit" class="btn btn-light mb-3"><i class="ti-search"></i></button>
						</div>
					</div>
				</div>
			</form>
            <div class="row mb-4">
                <!-- basic table start -->
                <div class="col-lg-12 mt-4">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="header-title">이벤트 관리</h4>
                            <div class="single-table">
                                <div class="table-responsive">
                                    <table class="table text-center">
                                        <thead class="text-uppercase">
                                            <tr>
                                                <th scope="col">NO</th>
                                                <th scope="col">썸네일</th>
                                                <th scope="col">제목</th>
												<th scope="col">이벤트기간</th>
                                                <th scope="col">관리</th>
                                            </tr>
                                        </thead>
										<tbody>
										<tr th:each="event, stat : ${eventList}">
										    <th scope="row" th:text="${stat.count}">1</th>

											<td th:onclick="|location.href='@{/admin/event_write/{id}(id=${event.id})}'|">
											    <img th:src="@{/upload/event/{file}(file=${event.thumbnail})}"
											         alt="썸네일"
											         style="width:80px; height:60px; object-fit:cover;">
											</td>

											<td th:text="${event.title}"
											    th:onclick="|location.href='@{/admin/event_write/{id}(id=${event.id})}'|">
											</td>

											<td th:text="|${event.startDate} ~ ${event.endDate}|">
											    2025-01-01 ~ 2025-01-31
											</td>

										    <td>
										        <button type="button"
										                class="btn btn-light"
										                th:onclick="|deleteItem(${event.id})|">
										            <i class="ti-trash"></i>
										        </button>
										    </td>
										</tr>
										</tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
			</div>

	</div>
	<!-- main content area end -->

	<script>
		function deleteItem(id) {
		    if (!confirm('정말 삭제하시겠습니까?')) return;

		    fetch(`/admin/event_delete/${id}`, { method: 'DELETE' })
		        .then(res => {
		            if (!res.ok) throw new Error('삭제 실패');
		            return res.text();
		        })
		        .then(() => location.reload())
		        .catch(err => alert(err.message));
		}
	</script>


    <!-- ⭐ footer include -->
    <div th:replace="fragments/fragments :: footer"></div>

</div>

<!-- jquery latest version -->
<script th:src="@{/assets/js/vendor/jquery-2.2.4.min.js}"></script>

<!-- bootstrap 4 js -->
<script th:src="@{/assets/js/popper.min.js}"></script>
<script th:src="@{/assets/js/bootstrap.min.js}"></script>

<script th:src="@{/assets/js/owl.carousel.min.js}"></script>
<script th:src="@{/assets/js/metisMenu.min.js}"></script>
<script th:src="@{/assets/js/jquery.slimscroll.min.js}"></script>
<script th:src="@{/assets/js/jquery.slicknav.min.js}"></script>

<!-- start chart js (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

<!-- start highcharts js (CDN) -->
<script src="https://code.highcharts.com/highcharts.js"></script>

<!-- start zingchart js (CDN) -->
<script src="https://cdn.zingchart.com/zingchart.min.js"></script>
<script>
    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
</script>

<!-- all line chart activation -->
<script th:src="@{/assets/js/line-chart.js}"></script>

<!-- all bar chart activation -->
<script th:src="@{/assets/js/bar-chart.js}"></script>

<!-- all pie chart -->
<script th:src="@{/assets/js/pie-chart.js}"></script>

<!-- others plugins -->
<script th:src="@{/assets/js/plugins.js}"></script>
<script th:src="@{/assets/js/scripts.js}"></script>

</body>
</html>
